function I=GaussKronrodQuad(f,a,b,k)
t=[-0.5773502692 -0.7745966692 -0.8611363116 -0.9061798459 -0.9324695142 -9.4910791234275852452618968404785126e-01 0 0 0 0 0 0 0 -9.9145537112081263920685469752632852e-01;
    0.5773502692  0            -0.3399810436 -0.5384693101 -0.6612093865 -7.4153118559939443986386477328078841e-01 0 0 0 0 0 0 0 -9.4910791234275852452618968404785126e-01;
    0             0.7745966692  0.3399810436  0            -0.2386191861 -4.0584515137739716690660641207696146e-01 0 0 0 0 0 0 0 -8.6486442335976907278971278864092620e-01;
    0             0             0.8611363116  0.5384693101  0.2386191861  0                                        0 0 0 0 0 0 0 -7.4153118559939443986386477328078841e-01;
    0             0             0             0.9061798459  0.6612093865  4.0584515137739716690660641207696146e-01 0 0 0 0 0 0 0 -5.8608723546769113029414483825872960e-01;
    0             0             0             0             0.9324695142  7.4153118559939443986386477328078841e-01 0 0 0 0 0 0 0 -4.0584515137739716690660641207696146e-01;
    0             0             0             0             0             9.4910791234275852452618968404785126e-01 0 0 0 0 0 0 0 -2.0778495500789846760068940377324491e-01;
    0             0             0             0             0             0                                        0 0 0 0 0 0 0  1.8367099231598242312011508394097589e-40;
    0             0             0             0             0             0                                        0 0 0 0 0 0 0  2.0778495500789846760068940377324491e-01;
    0             0             0             0             0             0                                        0 0 0 0 0 0 0  4.0584515137739716690660641207696146e-01;
    0             0             0             0             0             0                                        0 0 0 0 0 0 0  5.8608723546769113029414483825872960e-01;
    0             0             0             0             0             0                                        0 0 0 0 0 0 0  7.4153118559939443986386477328078841e-01;
    0             0             0             0             0             0                                        0 0 0 0 0 0 0  8.6486442335976907278971278864092620e-01;
    0             0             0             0             0             0                                        0 0 0 0 0 0 0  9.4910791234275852452618968404785126e-01;
    0             0             0             0             0             0                                        0 0 0 0 0 0 0  9.9145537112081263920685469752632852e-01];

c=[ 1             0.5555555555  0.3478548451  0.2369268850  0.1713244924  1.2948496616886969327061143267908202e-01 0 0 0 0 0 0 0 2.2935322010529224963732008058969592e-02;
    1             0.8888888888  0.6521451549  0.4786286705  0.3607615730  2.7970539148927666790146777142377958e-01 0 0 0 0 0 0 0 6.3092092629978553290700663189204287e-02; 
    0             0.5555555555  0.6521451549  0.5688888889  0.4679139346  3.8183005050511894495036977548897513e-01 0 0 0 0 0 0 0 1.0479001032225018383987632254151802e-01;
    0             0             0.3478548451  0.4786286705  0.4679139346  4.1795918367346938775510204081632653e-01 0 0 0 0 0 0 0 1.4065325971552591874518959051023792e-01;
    0             0             0             0.2369268850  0.3607615730  3.8183005050511894495036977548897513e-01 0 0 0 0 0 0 0 1.6900472663926790282658342659855028e-01;
    0             0             0             0             0.1713244924  2.7970539148927666790146777142377958e-01 0 0 0 0 0 0 0 1.9035057806478540991325640242101368e-01;
    0             0             0             0             0             1.2948496616886969327061143267908202e-01 0 0 0 0 0 0 0 2.0443294007529889241416199923464908e-01;
    0             0             0             0             0             0                                        0 0 0 0 0 0 0 2.0948214108472782801299917489171426e-01;
    0             0             0             0             0             0                                        0 0 0 0 0 0 0 2.0443294007529889241416199923464908e-01;
    0             0             0             0             0             0                                        0 0 0 0 0 0 0 1.9035057806478540991325640242101368e-01;
    0             0             0             0             0             0                                        0 0 0 0 0 0 0 1.6900472663926790282658342659855028e-01;
    0             0             0             0             0             0                                        0 0 0 0 0 0 0 1.4065325971552591874518959051023792e-01;
    0             0             0             0             0             0                                        0 0 0 0 0 0 0 1.0479001032225018383987632254151802e-01;
    0             0             0             0             0             0                                        0 0 0 0 0 0 0 6.3092092629978553290700663189204287e-02;
    0             0             0             0             0             0                                        0 0 0 0 0 0 0 2.2935322010529224963732008058969592e-02];

x(1:k)=0.5*((b-a).*t(1:k,k-1)+b+a);
y=feval(f,x);
cc(1:k)=c(1:k,k-1);
int=y*cc';
I=int*(b-a)/2;
end